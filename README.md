# excecss_mortality
日本でのCOVID-19による月ごとの超過死亡を都道府県別に、自治体ごとに計算します。  
pythonでコーディングしています。  
経験不足の初心者がコーディングしているので、スクリプトに過不足があり、また設計思想にも揺れがあります。  
ご意見、ご提案を歓迎します。  
## カバーできている都道府県  
本プロジェクトは開発進行中であり、都道府県ごとにデータセットおよび対応するスクリプトを作成しています。超過死亡が計算できる自治体（都道府県及び市町村）は、現在のところ以下の都道府県内のものに限られます（都道府県は順次追加されます）。  
### 北海道および東北  
### 関東
- 千葉県
- 埼玉県
- 東京都
- 神奈川県  
### 中部
- 愛知県
### 近畿
- 京都府
- 大阪府
- 兵庫県
### 中国  
### 四国  
### 九州および沖縄  
## 動作の要件  
- このシステムのコーディングには、python3.8、pycharm2020.2を使用しています。
- このシステムはwindows10で動作を確認しています。パス、文字コードの取り扱いもwindowsを前提としたものになっています。 
- このシステムはメッセージや出力結果、コメントに日本語を使用しています。
## システムの概要
システムは必要なデータが準備されていることを前提に、４つの段階で作動します。それぞれの段階では最初の手順でユーザーによるファイルの選択が必要とされます。また、各段階では最終的にファイルを出力します。  
### 0. データの準備  
このシステムは  
　1 都道府県単位でまとめられた  
　2 市町村別の  
　3 月ごとの  
死亡数のデータを必要とします。そこでまず、この条件を満たすデータを集めます（各都道府県のサイトを「人口の推計」「人口動態」などのキーワードで検索すると見つかることが多いです）。データは各月毎のファイルであることが多いですが、年毎のファイルであっても問題なく、両者が混在しても計算可能です（大都市では、混在している場合が多いです）。  
データは2012年から最新までのものが必要ですが、これ以前のデータも入力することができます（なお、この粗データは本レポジトリには含まれていません）。 
また、死亡データの期間をカバーする自治体の合併情報も必要となります。
### 1. 自治体の変更情報の整理  
- このシステムでは市町村の合併等の情報を自治体コードで処理しています。現存しない自治体のデータには、現在の自治体のコードが割り当てられます。このため、各都道府県について、計算を開始する前に自治体の合併についての情報をまとめた表を作成する必要があります。市町村合併の情報を提供しているサイト等で検索し、csvファイルを作成します。  
- ファイルには、「事由の日時」「旧自治体名」「変更事由」「新自治体名」「新自治体の自治体コード（空欄）」「都道府県名」が含まれなければなりません。それぞれの情報を列にし、一行目に、"date", "old_city", "event", "city", "code", "pref"という文字を記入します（自治体コードは処理過程で自動的に入力されます）。  
- 自治体変更情報をまとめたファイルは、このリポジトリの「data」フォルダにある都道府県別フォルダの中の「ref」フォルダに置いてあります。参考にご覧ください。
- ファイルができたら、"add_local_g_num.py"ファイルを実行し、指示に従ってcsvファイルを入力してください（複数のファイルを同時に選択することはできません）。  
### 2. 

